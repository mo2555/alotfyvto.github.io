import{FaceTracker as f,PoseTracker as r}from'@geenee/bodytracking';import{Processor as X,Engine as U,VideoCapture as e}from'@geenee/armature';class t extends X{constructor(){super(...arguments),this['faceTracker']=new f(),this['cameraAngleBase']=0xa/0xb4*Math['PI'];}async['init'](V,w,W){return await this['faceTracker']['init'](V['token'],V['root'],V['cache'],V['highp']),await this['faceTracker']['prepare'](),super['init'](V,w,W);}['reset'](){this['faceTracker']['reset'](),super['reset']();}['dispose'](){this['faceTracker']['dispose']();}async['process'](V,w){return{'faces':(await this['faceTracker']['process'](V,w))['map'](W=>{const v=W&&this['params']['transform']?this['faceTracker']['align'](W['keypoints']):void 0x0,g=v&&this['params']['metric']?this['faceTracker']['metricPoints']():void 0x0,G=v&&this['params']['backproj']?this['faceTracker']['backprojPoints']():void 0x0;return{'mesh':W,'transform':v,'metric':g,'backproj':G};})};}['setupVideo'](V,w){super['setupVideo'](V,w),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['faceTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['faceTracker']['reset']();}}class c extends U{constructor(V,w=e){super(t,V,w);}}class I extends X{constructor(){super(),this['poseTracker']=new r(),this['cameraAngleBase']=0xf/0xb4*Math['PI'];const V=/iPhone|iPad|iPod/i['test'](navigator['userAgent']);this['optimalSize']=V?0x200:0x400;}async['init'](V,w,W){return await this['poseTracker']['init'](V['token'],V['root'],V['cache'],V['mask']),await this['poseTracker']['prepare'](),super['init'](V,w,W);}['reset'](){return this['poseTracker']['reset'](),super['reset']();}['dispose'](){this['poseTracker']['dispose']();}async['process'](V,w){return{'poses':(await this['poseTracker']['process'](V,w))['map'](W=>({'points':Q['reduce']((v,g,G)=>(v[g]=W['keypoints'][G],v),{}),'score':W['score'],'mask':W['mask'],'debug':W['debug']}))};}['setupVideo'](V,w){super['setupVideo'](V,w),this['cameraAngle']=this['cameraRatio']>=0x1?this['cameraAngleBase']:0x2*Math['atan'](Math['tan'](0.5*this['cameraAngleBase'])/this['cameraRatio']),this['poseTracker']['setCamera'](this['cameraAngle'],this['cameraRatio'],0x1),this['poseTracker']['reset']();}}class A extends U{constructor(V,w=e){super(I,V,w);}}const Q=['nose','eyeInnerL','eyeL','eyeOutterL','eyeInnerR','eyeR','eyeOutterR','earL','earR','mouthL','mouthR','shoulderL','shoulderR','elbowL','elbowR','wristL','wristR','pinkyL','pinkyR','indexL','indexR','thumbL','thumbR','hipL','hipR','kneeL','kneeR','ankleL','ankleR','heelL','heelR','footIndexL','footIndexR'];export{c as FaceEngine,t as FaceProcessor,A as PoseEngine,I as PoseProcessor};
